---
layout: post
title: Deep learning method for synthesis of tabular data
date: '2019-02-11T13:45:00.000+02:00'
author: Juho Sarkamo
tags:
- AI
- transactions
- ML
- banking
- GAN
- DataSynthesis
nav_order: 9
modified_time: '2021-03-19T16:17:51.684+02:00'
thumbnail: /assets/images/4.bp.blogspot.com/-uY6r-qy5oNw/XGExcFE0sUI/AAAAAAAAADE/4OtSLDEK-SsZ_0qilQZpIbzEi-JxfX0KgCEwYBhgL/s72-c/mika-baumeister-703680-unsplash.jpg
blogger_id: tag:blogger.com,1999:blog-3014413452006891711.post-6941132371070959562
blogger_orig_url: https://blog.boogiesoftware.com/2019/02/deep-learning-method-for-synthesis-of.html
---

<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="/assets/images/4.bp.blogspot.com/-uY6r-qy5oNw/XGExcFE0sUI/AAAAAAAAADE/4OtSLDEK-SsZ_0qilQZpIbzEi-JxfX0KgCEwYBhgL/s1600/mika-baumeister-703680-unsplash.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="1068" data-original-width="1600" height="133" src="/assets/images/4.bp.blogspot.com/-uY6r-qy5oNw/XGExcFE0sUI/AAAAAAAAADE/4OtSLDEK-SsZ_0qilQZpIbzEi-JxfX0KgCEwYBhgL/s200/mika-baumeister-703680-unsplash.jpg" width="200" /></a></div>In this post I present a study conducted here at <a href="https://boogiesoftware.com/">Boogie Software</a> by the <a href="https://boogiesoftware.com/ai/">Boogie Artificial Intelligence Team.</a> The purpose is to investigate the feasibility of deep learning techniques for synthesis of tabular data. The study is carried out through an example case where bank transaction data is used. The subject is relevant for example to the <a href="https://blog.boogiesoftware.com/2019/01/first-hand-experiences-with-open.html">open banking initiative</a> discussed earlier in our blog post, and is a continuation of a post which discussed the use of <a href="https://blog.boogiesoftware.com/2019/01/credit-risk-profiling-using-open-bank.html">banking data for predictive analytics.</a> <br /><br />I start by introducing the concepts of data synthesis and a particular deep learning method called Generative Adversarial Networks. After the introduction, I describe our work on the synthesis of bank transaction data, and present that the method succeeds in synthesizing categorical, numerical and date variables. I conclude that the method can be used for creating software test data and also for training machine learning models.<br /><h3><span style="color: red;"><span style="font-size: large;"><span style="color: black;">Data synthesis </span></span></span></h3>Have you ever had a novel idea for utilizing data, but dropped the idea simply because the data is inaccessible? Or, wouldn't it be great to do software development with test data resembling the private data used in production? Synthetic data can help here.<br /><blockquote class="tr_bq"><i>Is your data too private to share?</i></blockquote>Data synthesis is the act of generating artificial data for the purposes of software development, system testing or data analysis. Synthetic data can mimic the data produced by measurements or collected from customer actions. Unlike real data, synthetic data can be anonymous and shared without any privacy concerns, and it can be generated in unconfined quantities. Minimally, the synthetic data is expected to represent the real data at a formal level, while at its best it can replace the real data for analysis or machine learning purposes. Methods for synthesis vary depending on the kind of data and on the requirements imposed on it. There is active research going on, see for example <a href="http://www.vldb.org/pvldb/vol11/p1071-park.pdf">"Data synthesis based on Generative Adversarial Networks"</a> and <a href="https://dai.lids.mit.edu/wp-content/uploads/2018/03/SDV.pdf">"The synthetic Data Vault"</a>.<br /><h3><span style="font-size: large;">Generative Adversarial Networks in transaction synthesis</span></h3>A class of deep learning methods called Generative Adversarial Networks (GAN) has gained a wide interest during the last years especially through the advances in image synthesis. Synthetic images generated by GANs are conceptually somewhat like dreams: all the inputs from reality blend together in their different forms and combine into outputs which do not have a correspondence in reality but still feel familiar. If the topic is new to you, check out the <a href="https://research.nvidia.com/publication/2017-10_Progressive-Growing-of">wonder of synthetic celebrity images</a> and the <a href="https://github.com/nashory/gans-awesome-applications">wide range of applications of GANs</a>.<br /><br />Here we investigate a practical approach with potential in opening wide  landscapes for industrial use of GANs. We are interested  in the synthesis of data which is in tabular form.<span style="color: red;"> </span>Tables of data are  everywhere, many sealed in the binary vaults of industries, but  glimmering there as valuable as gold. If the gold canâ€™t be shared, share  a synthesized version of it!<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="/assets/images/2.bp.blogspot.com/-UdSo4m6LTJ0/XFqyxKCkshI/AAAAAAAAACo/fw932o6A1Es27wJgiuTXbvg1AwzxgUzAgCEwYBhgL/s1600/gan_picture_v3_with_title.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="786" data-original-width="1141" src="/assets/images/2.bp.blogspot.com/-UdSo4m6LTJ0/XFqyxKCkshI/AAAAAAAAACo/fw932o6A1Es27wJgiuTXbvg1AwzxgUzAgCEwYBhgL/s1600/gan_picture_v3_with_title.png" /></a></div><br />The high-level concepts for synthesis of transaction data with GAN are depicted in the figure above. The main components of GAN are called a generator and a discriminator. The generator is a neural network, which maps random numbers into fake transaction samples. The discriminator is another network, which takes in these fake samples together with samples from real data and classifies each sample as either real or fake. The discriminator aims to classify the samples correctly, while the generator aims to fool the discriminator. During the network training, the feedback from the improving discriminator forces the generator to generate transactions that are similar to the real ones. <br /><br />After the training is finished, the trained generator can be used to create authentic-looking data. Just input any number into the generator and it will output a transaction!<br /><h3><span style="font-size: large;">Our exercise with banking data</span></h3>The data set used in our synthesis exercise contains ca. 1 million transactions from 4500 different customers. It is one of the most versatile public banking data sets available online and contains information of all main aspects of bank transactions: date and amount of transaction, account balance and transaction categories (ie. characteristics of the transaction, such as transaction type, bank and payment information).<br /><br />We have experimented with different GAN architectures and training approaches, and we found that Wasserstein GAN (WGAN) is preferred for synthesis since it is stable to train and yields the best results. We train the network using cloud services hosting virtual machines employing graphics processing units (GPU). We test multilayer perceptron architectures (MLP) for which the training time can be up to ~10 hours.<br /><div style="text-align: left;"></div><h3><span style="font-size: large;">Evaluation of synthesized transactions</span></h3>After the generator is trained, synthesized data is easily produced in unconfined numbers, and we are interested in the statistical resemblance between the data and the synthesized version of it. The synthesis works well for categorical, numerical and date variables, as shown in the figures below.<br /><h4 style="text-align: center;"><i>Categorical variables</i></h4><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="/assets/images/2.bp.blogspot.com/-wwo8jX3-lwY/XE7_xXcUdQI/AAAAAAAAABc/QY9GxHiAqvEzErAGMTwxWN97dKSCCxaKQCEwYBhgL/s1600/transaction_numbers_v9.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="605" data-original-width="972" src="/assets/images/2.bp.blogspot.com/-wwo8jX3-lwY/XE7_xXcUdQI/AAAAAAAAABc/QY9GxHiAqvEzErAGMTwxWN97dKSCCxaKQCEwYBhgL/s1600/transaction_numbers_v9.png" /></a></td></tr><tr align="left"><td class="tr-caption"><span style="font-size: small;"><i>Relative number of transactions for different transaction  categories in real data (blue) and synthesized data (red).  Each marker denotes a specific combination of transaction categories  (A marker indicate</i></span><span style="font-size: small;"><i><span style="font-size: small;"><i>s for example the number of cash withdrawals</i></span>, the number of incoming  pension transactions from a particular bank, and so on).</i></span></td><td class="tr-caption"><br /></td></tr></tbody></table><br />The relative numbers of different transaction categories are well  preserved in the synthesis, as the figure above clearly demonstrates. The  numbers of the most common transactions are accurately produced, and the  synthesized data matches the real data over a wide range of  frequencies. The numbers of some of the most infrequent categories are underproduced. Generally, the longer the network is trained, the more of the categories are correctly produced.<span style="color: red;"><span style="color: black;"> </span></span><br /><h4 style="text-align: center;"><i>Numerical variables</i></h4><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><!---<tbody><tr align="left"><td class="tr-caption" style="text-align: left;"><br /></td><td class="tr-caption"></td></tr>--></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="/assets/images/2.bp.blogspot.com/-nT8gSFy0miU/XFrf-L9m5bI/AAAAAAAAAC4/REeTw5fpaacdEWU0LETo_R--HKZmdW45QCEwYBhgL/s1600/amount_balance_v3.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="818" data-original-width="1600" src="/assets/images/2.bp.blogspot.com/-nT8gSFy0miU/XFrf-L9m5bI/AAAAAAAAAC4/REeTw5fpaacdEWU0LETo_R--HKZmdW45QCEwYBhgL/s1600/amount_balance_v3.png" /></a></td></tr><tr align="left"><td class="tr-caption"><span style="font-size: small;">The distribution of transactions as a function of transaction amounts and account balances for real data (left) and for synthesized data (right). The colors indicate the number of transactions. Note that the axes are logarithmic, and that the colors pronounce the smallest details in data.</span></td></tr></tbody></table><br />The figure above shows the number of transactions as a function of transaction amount  and account balance. The data clearly shows three dominant regions  (â€™redâ€™ regions in the figure), which correspond to transactions with  different amounts. These three regions are correctly produced in the synthesis, and, as indicated by the shapes of the regions, the  synthesis also captures the covariance between the variables!<br /><h4 style="text-align: center;"><i>Date variables</i><a href="https://1.bp.blogspot.com/-Yu6d7G0qJHs/XE8BB4tuJfI/AAAAAAAAABk/i1d5-IvoYnsNIKneR348uA-3-bn0ttF9QCLcBGAs/s1600/date_components_v10.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="399" data-original-width="970" src="https://1.bp.blogspot.com/-Yu6d7G0qJHs/XE8BB4tuJfI/AAAAAAAAABk/i1d5-IvoYnsNIKneR348uA-3-bn0ttF9QCLcBGAs/s1600/date_components_v10.png" /></a></h4><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr align="left"><td class="tr-caption"><span style="font-size: small;"><i>The distributions of days of the month (left panel) and  months (right panel) of the transactions. The distributions are shown  for both the real data (blue) and synthetic data (red).</i></span></td></tr></tbody></table><br />The dates of transactions are also correctly synthesized as depicted in  the figure above. <br /><br />GAN succeeds in generating synthetic data with the following properties: the relative numbers between different categories, the distribution of dates of the transactions, and the distributions of transaction amounts and account balances are preserved. Much of the covariance between the variables is preserved. The synthesis does neglect or transform some fine details of the data in an unpredictable way. Depending on the requirements of its use, this can be seen either as a limitation or as a preferred feature of the synthesis<i>. </i><br /><h3 style="text-align: left;"><span style="font-size: large;">Usability of synthetic data for machine learning?</span></h3><div class="separator" style="clear: both; text-align: left;">We are also interested if synthetic data could be used for training a machine learning model, and we conduct a simple exercise on that matter. The idea behind is that an owner of private data could release a synthetic version of his data for machine learning studies, thus avoiding possible privacy issues. </div><br />In our machine learning example, we first classify all customers  into separate classes. The classification is based on the aggregated values  of account balances and transaction amounts, as well as on the temporal  densities of different transaction categories. See the figure below for a  visualization of the customer classes.<br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="/assets/images/4.bp.blogspot.com/-CpqBdZWxQxY/XE7aWZdvVNI/AAAAAAAAAAo/GaCiP_8N4QsyhkIMkhVYJBbwNSx7ZqCuQCLcBGAs/s1600/pca_v4.png" style="clear: right; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" data-original-height="1001" data-original-width="1600" src="/assets/images/4.bp.blogspot.com/-CpqBdZWxQxY/XE7aWZdvVNI/AAAAAAAAAAo/GaCiP_8N4QsyhkIMkhVYJBbwNSx7ZqCuQCLcBGAs/s1600/pca_v4.png" /></a></td></tr><tr align="left"><td class="tr-caption"><span style="font-size: small;"><i>Spectral clustering of different customers visualized in PCA  (Principal Component Analysis) space. Each marker represents one  customer and colors indicate the customer class.</i></span></td></tr></tbody></table><br />We then label each transaction by the class of the customer carrying the transaction, and the label is also included in the synthesis. We train Gradient Boosting Classifiers to predict the labels of real transactions, and compare the classification metrics between models trained on synthetic and real data. The metrics are shown in the figure below.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-yz_wudkIjrw/XFLmMn8x_5I/AAAAAAAAACA/iarY5BHH9Q0rMCr3IBV1k_JmN1Tjtl43gCEwYBhgL/s1600/classification_v8.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="507" data-original-width="940" src="https://1.bp.blogspot.com/-yz_wudkIjrw/XFLmMn8x_5I/AAAAAAAAACA/iarY5BHH9Q0rMCr3IBV1k_JmN1Tjtl43gCEwYBhgL/s1600/classification_v8.png" /></a></td></tr><tr align="left"><td class="tr-caption"><span style="font-size: small;"><i>The classification metrics for four major customer classes. Precision (the fraction of correct predictions) (right panel) and recall (the fraction of labels which are correctly predicted) (left panel). The  classifier is trained either with real transactions (blue) or with  synthetic transactions (red). The baseline prediction denotes random  guesses for the labels (orange). All cases are evaluated against the real  transaction set.</i></span></td><td class="tr-caption"></td></tr></tbody></table><br />The classifier trained on the synthetic data approaches the quality of the classifier trained on the real data, and is way better than a random guess.<br /><h3><span style="font-size: large;">Concluding remarks</span></h3>Our work above demonstrates that a class of deep learning technique called Generative Adversarial Networks can be used to synthesize data in tabular form. This was shown through the example case of bank transaction synthesis, but the method should be applicable to different types of tabular data as well. Synthesized data can be a perfect replacement of data for technical testing of software systems.<br /><br />The example scenario of transaction classification shows that the data synthesized by GAN can be used at least as an initial step in the development of machine learning models, but it would be an overstatement to conclude that it can replace it altogether. The applicability will surely depend on the problem in question. <br /><br />Personally I feel that GANs are very interesting option for data synthesis. Only future work will tell how much more these intelligent machines are able to do! <br /><br />If you're interested around any of the topics discussed, check out the <a href="https://boogiesoftware.com/ai/">AI Team</a> offering and contact us. <br /><h3><span style="font-size: large;">References</span></h3><ul><li>Boogie Software Oy is a private Finnish company headquartered in Oulu, Finland. Our unique company profile builds upon top level software competence, entrepreneurial spirit and humane work ethics. The key to our success is close co-operation with the most demanding customers, understanding their business and providing accurate software solutions for complex problems.</li><li>The open bank data used in the article can be found in the following link<a href="https://sorry.vse.cz/~berka/challenge/"> https://sorry.vse.cz/~berka/challenge/</a>.</li><li>The analysis has been done using <a href="http://www.numpy.org/">numpy</a>, <a href="https://pandas.pydata.org/">pandas</a>, <a href="https://lightgbm.readthedocs.io/en/latest/">lightgbm </a>and <a href="https://scikit-learn.org/stable/">scikit-learn</a> Python libraries. The figures have been created using <a href="https://matplotlib.org/">matplotlib</a> and <a href="https://seaborn.pydata.org/">seaborn </a>libraries.</li><li>For building and training deep learning models <a href="https://keras.io/">keras</a> library and <a href="https://www.tensorflow.org/guide/summaries_and_tensorboard">tensorboard</a> visualizations are used. Our code utilizes the <a href="https://github.com/keras-team/keras-contrib/blob/master/examples/improved_wgan.py">wgan-improved</a> repository for WGAN training. </li></ul><br />